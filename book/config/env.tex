
%----------------------------------------------
% PART INTRODUCTION ENVIRONMENT
% Clean, centered introduction for each part
%----------------------------------------------
\newenvironment{partintro}{%
    \vspace{3em}
    \begin{center}
    \begin{minipage}{0.80\textwidth}
        \setlength{\parindent}{0pt}
        \setlength{\parskip}{1em}
        \itshape
        \color{textgray}
        \fontsize{11pt}{16pt}\selectfont
}{%
    \end{minipage}
    \end{center}
    \vspace{3em}
    \noindent
}

%----------------------------------------------
% CHAPTER INTRODUCTION ENVIRONMENT
% Subtle left border, generous spacing
%----------------------------------------------
\newenvironment{chapterintro}{%
    \vspace{1.5em}
    \begin{tcolorbox}[
        enhanced,
        colback=white,
        colframe=white,
        boxrule=0pt,
        borderline west={4pt}{0pt}{arlizblue!60},
        sharp corners,
        left=16pt,
        right=12pt,
        top=12pt,
        bottom=12pt,
        breakable,
        before skip=12pt,
        after skip=18pt,
        parbox=false
    ]
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{0.8em}
    \color{textgray}
    \fontsize{10.5pt}{15pt}\selectfont
}{%
    \end{tcolorbox}
    \noindent
}

%----------------------------------------------
% SECTION INTRODUCTION ENVIRONMENT
% Lighter, more subtle than chapter intro
%----------------------------------------------
\newenvironment{sectionintro}{%
    \vspace{1em}
    \begin{tcolorbox}[
        enhanced,
        colback=subtle,
        colframe=subtle,
        boxrule=0pt,
        sharp corners,
        left=12pt,
        right=12pt,
        top=10pt,
        bottom=10pt,
        breakable,
        before skip=10pt,
        after skip=14pt,
        parbox=false
    ]
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{0.6em}
    \small
    \itshape
    \color{textgray}
}{%
    \end{tcolorbox}
    \noindent
}

%----------------------------------------------
% SUBSECTION INTRODUCTION ENVIRONMENT
% Minimal quote-style introduction
%----------------------------------------------
\newenvironment{subsectionintro}{%
    \vspace{0.8em}
    \begin{quote}
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{0.5em}
    \small
    \itshape
    \color{textgray}
}{%
    \end{quote}
    \vspace{0.5em}
    \noindent
}


%----------------------------------------------
% HISTORICAL NOTE ENVIRONMENT
% For historical context and background
%----------------------------------------------
\newenvironment{historical}{%
    \vspace{1em}
    \begin{tcolorbox}[
        enhanced,
        colback=arliznavy!2,
        colframe=arliznavy!30,
        boxrule=0.5pt,
        arc=3pt,
        left=14pt,
        right=14pt,
        top=12pt,
        bottom=12pt,
        breakable,
        before skip=10pt,
        after skip=14pt,
        title={\small\scshape\color{arliznavy!80}Historical Context},
        fonttitle=\sffamily\bfseries,
        coltitle=arliznavy!80,
        attach boxed title to top left={yshift=-3mm, xshift=8mm},
        boxed title style={
            colback=white,
            colframe=arliznavy!30,
            boxrule=0.5pt
        }
    ]
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{0.7em}
    \small
    \color{textgray}
}{%
    \end{tcolorbox}
    \noindent
}

%----------------------------------------------
% EXAMPLE ENVIRONMENT
% For worked examples and demonstrations
%----------------------------------------------
\newenvironment{example}[1][]{%
    \vspace{1em}
    \begin{tcolorbox}[
        enhanced,
        colback=green!3,
        colframe=green!60!black,
        boxrule=0.5pt,
        arc=2pt,
        left=12pt,
        right=12pt,
        top=10pt,
        bottom=10pt,
        breakable,
        before skip=10pt,
        after skip=12pt,
        title={\small\textbf{Example\if\relax\detokenize{#1}\relax\else: #1\fi}},
        fonttitle=\sffamily,
        coltitle=green!60!black
    ]
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{0.6em}
}{%
    \end{tcolorbox}
    \noindent
}

%----------------------------------------------
% DEFINITION ENVIRONMENT
% For formal definitions
%----------------------------------------------
\newenvironment{definition}[1][]{%
    \vspace{1em}
    \begin{tcolorbox}[
        enhanced,
        colback=arlizblue!5,
        colframe=arlizblue!70,
        boxrule=1pt,
        arc=0pt,
        sharp corners,
        left=14pt,
        right=14pt,
        top=12pt,
        bottom=12pt,
        breakable,
        before skip=10pt,
        after skip=14pt,
        title={\small\textbf{Definition\if\relax\detokenize{#1}\relax\else: #1\fi}},
        fonttitle=\sffamily\bfseries,
        coltitle=arlizblue!90
    ]
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{0.6em}
}{%
    \end{tcolorbox}
    \noindent
}

%----------------------------------------------
% THEOREM/PROPOSITION ENVIRONMENT
% For formal mathematical statements
%----------------------------------------------
\newenvironment{theorem}[1][]{%
    \vspace{1em}
    \begin{tcolorbox}[
        enhanced,
        colback=arliznavy!5,
        colframe=arliznavy!70,
        boxrule=1pt,
        arc=0pt,
        sharp corners,
        left=14pt,
        right=14pt,
        top=12pt,
        bottom=12pt,
        breakable,
        before skip=10pt,
        after skip=14pt,
        title={\small\textbf{Theorem\if\relax\detokenize{#1}\relax\else: #1\fi}},
        fonttitle=\sffamily\bfseries,
        coltitle=arliznavy!90
    ]
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{0.6em}
    \itshape
}{%
    \end{tcolorbox}
    \noindent
}

%----------------------------------------------
% PROOF ENVIRONMENT
% Clean, minimal proof environment
%----------------------------------------------
\newenvironment{proof}{%
    \vspace{0.5em}
    \noindent\textit{Proof.}\hspace{0.5em}
    \begin{adjustwidth}{1.5em}{0pt}
}{%
    \hfill$\square$
    \end{adjustwidth}
    \vspace{0.5em}
    \noindent
}

%----------------------------------------------
% IMPLEMENTATION NOTE ENVIRONMENT
% For practical implementation details
%----------------------------------------------
\newenvironment{implementation}{%
    \vspace{1em}
    \begin{tcolorbox}[
        enhanced,
        colback=orange!5,
        colframe=orange!70!black,
        boxrule=0.5pt,
        arc=2pt,
        left=12pt,
        right=12pt,
        top=10pt,
        bottom=10pt,
        breakable,
        before skip=10pt,
        after skip=12pt,
        title={\small\texttt{Implementation Detail}},
        fonttitle=\sffamily\bfseries,
        coltitle=orange!70!black
    ]
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{0.6em}
    \small
}{%
    \end{tcolorbox}
    \noindent
}
