%----------------------------------------------
% Page Styles and Headers/Footers
%----------------------------------------------
\usepackage{fancyhdr}              % Enhanced header/footer control
\usepackage{lastpage}              % For total page count reference
\usepackage{ifthen}                % Conditional formatting

%----------------------------------------------
% Clear Default Headers and Footers
%----------------------------------------------
\fancyhf{}                         % Clear all headers and footers
\renewcommand{\headrulewidth}{0pt} % Remove default header rule
\renewcommand{\footrulewidth}{0pt} % Remove default footer rule
%----------------------------------------------
% Custom Rule Definitions
%----------------------------------------------
% Header rule with custom color and thickness
\newcommand{\headerrule}{%
	\color{headerblue}\hrule width\headwidth height 0.6pt
}

% Footer rule with custom color and thickness
\newcommand{\footerrule}{%
	\color{footerline}\hrule width\headwidth height 0.4pt
}

% Decorative rule for special pages
\newcommand{\decorativerule}{%
	\begingroup
	\color{arlizlightblue}%
	\rule{0.3\textwidth}{1.2pt}%
	\endgroup
}
%----------------------------------------------
% Main Page Style (for regular content pages)
%----------------------------------------------
\fancypagestyle{main}{
	\fancyhf{} % Clear all
	
	% Headers for odd pages (right-hand pages)
	\fancyhead[RO]{
	     \headerfont\color{headerblue}
		{\nouppercase{\rightmark}} % Section title
	}
	\fancyhead[LO]{
		\headerfont\color{headerblue}
		{\textsc{ARLIZ}} % Book title
	}

	% Headers for even pages (left-hand pages)  
	\fancyhead[LE]{
     	\headerfont\color{headerblue}
		{\nouppercase{\leftmark}} % Chapter title
	}
	\fancyhead[RE]{
		\headerfont\color{headerblue}{\textsc{Arrays, Reasoning, Logic, Identity, Zero}}
	}
	
   % Footers
	\fancyfoot[LE]{%
		\footerfont\color{footergray}%
		\textbf{\thepage}\ \textbar\ \pageref{LastPage}%
	}
	\fancyfoot[RO]{%
		\footerfont\color{footergray}%
		\textbf{\thepage}\ \textbar\ \pageref{LastPage}%
	}
	 \fancyfoot[RE]{%
		\footerfont\color{textsecondary}%
		\textit{Mahdi \textbullet\ MIT License}%
	}
	 \fancyfoot[LO]{%
		\footerfont\color{textsecondary}%
		\textit{First Edition \textbullet\ \the\year}%
	}
	
	% Custom header and footer rules
	\renewcommand{\headrulewidth}{0.6pt}
	\renewcommand{\footrulewidth}{0.4pt}
	\renewcommand{\headrule}{\hbox to\headwidth{\color{myblue}\leaders\hrule height \headrulewidth\hfill}}
	\renewcommand{\footrule}{\hbox to\headwidth{\color{gray!50}\leaders\hrule height \footrulewidth\hfill}}
}

%----------------------------------------------
% Chapter Opening Pages Style
%----------------------------------------------
\fancypagestyle{chapter}{
	\fancyhf{} % Clear all
	\renewcommand{\headrulewidth}{0pt} % No header rule
	\renewcommand{\footrulewidth}{0pt} % No footer rule
	
	% Minimal footer for chapter opening pages
	 \fancyfoot[C]{%
		\footerfont\color{arlizblue}%
		\decorativerule\quad%
		\textbf{\large\thepage}%
		\quad\decorativerule%
	}
}

%----------------------------------------------
% Front Matter Style (TOC, Preface, etc.)
%----------------------------------------------
\fancypagestyle{frontmatter}{
		 % Simple centered header
		\fancyhead[C]{%
			\headerfont\color{headerblue}%
			\textsc{Arliz \textbullet\ Front Matter}%
		}

	
		% Roman numeral page numbers
		\fancyfoot[C]{%
			\pagenotefont\color{footergray}%
			\textbf{\thepage}%
		}
	
	% Lighter rules for front matter
	\renewcommand{\headrule}{
		\color{headerblue!70}\hrule width\headwidth height\headrulewidth
	}
	\renewcommand{\footrule}{
		\color{footergray!50}\hrule width\headwidth height\footrulewidth
	}
}
%----------------------------------------------
% Part Opening Pages Style
%----------------------------------------------
\fancypagestyle{part}{%
	\fancyhf{} % Clear all
	\renewcommand{\headrulewidth}{0pt} % No header rule
	\renewcommand{\footrulewidth}{0pt} % No footer rule
}


%----------------------------------------------
% Bibliography and Index Style
%----------------------------------------------
\fancypagestyle{backmatter}{
	\fancyhf{} % Clear all
	
	% Headers 
	\fancyhead[LE,RO]{
		\headerfont\color{headerblue}{\nouppercase{\leftmark}}
	}
	\fancyhead[LO,RE]{
		\headerfont\color{textsecondary}{\textsc{Arliz  \textbullet\ References}}
	}
	
	% Standard page numbers for back matter
	\fancyfoot[LE,RO]{
		\footerfont\color{footergray}{\textbf{\thepage}}
	}
	\fancyfoot[LO,RE]{
		\footerfont\color{textsecondary}{\textit{Back Matter}}
	}
	
	% Standard rules
	\renewcommand{\headrulewidth}{0.5pt}
	\renewcommand{\footrulewidth}{0.3pt}
 \renewcommand{\headrule}{\headerrule}
\renewcommand{\footrule}{\footerrule}
}

%----------------------------------------------
% Empty Style (for title page, copyright, etc.)
%----------------------------------------------
\fancypagestyle{empty}{
	\fancyhf{} % Completely clear
	\renewcommand{\headrulewidth}{0pt}
	\renewcommand{\footrulewidth}{0pt}
}

%----------------------------------------------
% Apply Styles Throughout Document
%----------------------------------------------

% Set main page style as default
\pagestyle{main}

\let\oldchapter\chapter
\renewcommand{\chapter}{
	\cleardoublepage
	\thispagestyle{chapter}
	\oldchapter
}

\let\oldpart\part
\renewcommand{\part}{
	\clearpage
	\thispagestyle{part}
	\oldpart
}
% Front matter setup
\let\oldfrontmatter\frontmatter
\renewcommand{\frontmatter}{
	\oldfrontmatter
	\pagestyle{frontmatter}
}

% Main matter setup  
\let\oldmainmatter\mainmatter
\renewcommand{\mainmatter}{
	\oldmainmatter
	\pagestyle{main}
}

% Back matter setup
\let\oldbackmatter\backmatter
\renewcommand{\backmatter}{
	\oldbackmatter
	\pagestyle{backmatter}
}

%----------------------------------------------
% Custom Page Style Commands
%----------------------------------------------

% Command to return to main style
\newcommand{\mainstyle}{\pagestyle{main}}