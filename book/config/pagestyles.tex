%----------------------------------------------
% Page Styles and Headers/Footers
%----------------------------------------------
\usepackage{fancyhdr}              % Enhanced header/footer control
\usepackage{lastpage}              % For total page count reference
\usepackage{ifthen}                % Conditional formatting

%----------------------------------------------
% Clear all default headers and footers
%----------------------------------------------
\fancyhf{}

%----------------------------------------------
% Define custom line thickness and colors
%----------------------------------------------
\renewcommand{\headrulewidth}{0.8pt}
\renewcommand{\footrulewidth}{0.4pt}

%----------------------------------------------
% Main Page Style (for regular content pages)
%----------------------------------------------
\fancypagestyle{main}{
	\fancyhf{} % Clear all
	
	% Headers for odd pages (right-hand pages)
	\fancyhead[RO]{
		\small\textcolor{headerblue}{\textbf{\nouppercase{\rightmark}}} % Section title
	}
	\fancyhead[LO]{
		\small\textcolor{headerblue}{\textsc{Arliz}} % Book title
	}
	
	% Headers for even pages (left-hand pages)  
	\fancyhead[LE]{
		\small\textcolor{headerblue}{\textbf{\nouppercase{\leftmark}}} % Chapter title
	}
	\fancyhead[RE]{
		\small\textcolor{headerblue}{\textsc{Arrays, Logic, Identity, Zero}}
	}
	
	% Footers for odd pages (right-hand pages)
	\fancyfoot[RO]{
		\thepage of \textbf{\pageref{LastPage}}
	}
	
	% Footers for even pages (left-hand pages)
	\fancyfoot[LE]{
		\textbf{\thepage}\ of \textbf{\pageref{LastPage}}
	}
	\fancyfoot[RE]{
		\textit{Mahdi • MIT License}
	}
	
	% Custom header and footer rules
	\renewcommand{\headrulewidth}{0.5pt}
	\renewcommand{\footrulewidth}{0.3pt}
	\renewcommand{\headrule}{\hbox to\headwidth{\color{myblue}\leaders\hrule height \headrulewidth\hfill}}
	\renewcommand{\footrule}{\hbox to\headwidth{\color{gray!50}\leaders\hrule height \footrulewidth\hfill}}
}

%----------------------------------------------
% Chapter Opening Pages Style
%----------------------------------------------
\fancypagestyle{chapter}{
	\fancyhf{} % Clear all
	\renewcommand{\headrulewidth}{0pt} % No header rule on chapter pages
	\renewcommand{\footrulewidth}{0.4pt}
	
	% Minimal footer for chapter opening pages
	\fancyfoot[C]{
		\small\textcolor{footergray}{
			\rule{2cm}{0.4pt}\ \textbf{\thepage}\ \rule{2cm}{0.4pt}
		}
	}
	
	% Custom footer rule for chapter pages
	\renewcommand{\footrule}{
		\color{footergray}\hrule width\headwidth height\footrulewidth
	}
}

%----------------------------------------------
% Front Matter Style (TOC, Preface, etc.)
%----------------------------------------------
\fancypagestyle{frontmatter}{
	\fancyhf{} % Clear all
	\renewcommand{\headrulewidth}{0.4pt}
	\renewcommand{\footrulewidth}{0.4pt}
	
	% Simple headers for front matter
	\fancyhead[C]{
		\small\textcolor{headerblue}{\textsc{Arliz • Front Matter}}
	}
	
	% Roman numerals for front matter pages
	\fancyfoot[C]{
		\small\textcolor{footergray}{
			\textbf{\thepage}
		}
	}
	
	% Lighter rules for front matter
	\renewcommand{\headrule}{
		\color{headerblue!50}\hrule width\headwidth height\headrulewidth
	}
	\renewcommand{\footrule}{
		\color{footergray!50}\hrule width\headwidth height\footrulewidth
	}
}

%----------------------------------------------
% Bibliography and Index Style
%----------------------------------------------
\fancypagestyle{backmatter}{
	\fancyhf{} % Clear all
	\renewcommand{\headrulewidth}{0.6pt}
	\renewcommand{\footrulewidth}{0.4pt}
	
	% Headers for bibliography/index
	\fancyhead[LE,RO]{
		\small\textcolor{headerblue}{\textbf{\nouppercase{\leftmark}}}
	}
	\fancyhead[LO,RE]{
		\small\textcolor{headerblue}{\textsc{Arliz • References \& Index}}
	}
	
	% Standard page numbers for back matter
	\fancyfoot[LE,RO]{
		\small\textcolor{footergray}{\textbf{\thepage}}
	}
	\fancyfoot[LO,RE]{
		\small\textcolor{footergray}{\textit{Back Matter}}
	}
	
	% Standard rules
	\renewcommand{\headrule}{
		\color{headerblue}\hrule width\headwidth height\headrulewidth
	}
	\renewcommand{\footrule}{
		\color{footergray}\hrule width\headwidth height\footrulewidth
	}
}

%----------------------------------------------
% Empty Style (for title page, copyright, etc.)
%----------------------------------------------
\fancypagestyle{empty}{
	\fancyhf{} % Completely clear
	\renewcommand{\headrulewidth}{0pt}
	\renewcommand{\footrulewidth}{0pt}
}

%----------------------------------------------
% Apply Styles Throughout Document
%----------------------------------------------

% Set main page style as default
\pagestyle{main}

% Automatic style switching for different document parts
\let\oldchapter\chapter
\renewcommand{\chapter}{
	\cleardoublepage
	\thispagestyle{chapter}
	\oldchapter
}

% Front matter setup
\let\oldfrontmatter\frontmatter
\renewcommand{\frontmatter}{
	\oldfrontmatter
	\pagestyle{frontmatter}
}

% Main matter setup  
\let\oldmainmatter\mainmatter
\renewcommand{\mainmatter}{
	\oldmainmatter
	\pagestyle{main}
}

% Back matter setup
\let\oldbackmatter\backmatter
\renewcommand{\backmatter}{
	\oldbackmatter
	\pagestyle{backmatter}
}
